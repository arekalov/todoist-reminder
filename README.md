# Todoist Reminder App

Android приложение-напоминатель с интеграцией MCP сервера для получения задач из Todoist и Yandex GPT для их форматирования.

## Архитектура

```
Android App → HTTP → MCP Server (localhost:1234) → Todoist API
           → HTTP → Yandex GPT API
```

## Стек технологий

- **Kotlin**
- **Jetpack Compose** + **Material 3**
- **Hilt** для Dependency Injection
- **Ktor Client** для HTTP запросов
- **WorkManager** для фоновых задач
- **DataStore** для хранения настроек
- **Navigation Compose** для навигации

## Структура проекта

```
app/src/main/java/com/arekalov/todoistreminder/
├── data/
│   ├── remote/
│   │   ├── mcp/ (MCP API клиент)
│   │   └── yandex/ (Yandex GPT API)
│   └── local/ (DataStore репозиторий)
├── domain/
│   ├── model/ (доменные модели)
│   ├── repository/ (интерфейсы репозиториев)
│   └── usecase/ (бизнес-логика)
├── presentation/
│   ├── tasks/ (экран задач)
│   ├── settings/ (экран настроек)
│   └── navigation/ (навигация)
├── workers/ (WorkManager workers)
├── notifications/ (система уведомлений)
├── di/ (Hilt модули)
└── MainActivity.kt
```

## Настройка проекта

### 1. Клонирование и настройка

```bash
cd /Users/arekalov/Yandex.Disk.localized/Dev/todoistreminder
```

### 2. Создание local.properties

Скопируйте `local.properties.example` в `local.properties` и заполните своими ключами:

```properties
sdk.dir=/path/to/your/Android/sdk

YANDEX_API_KEY=your_yandex_api_key
YANDEX_FOLDER_ID=your_folder_id
MCP_SERVER_URL=http://10.0.2.2:1234
```

**Важно**: 
- Для эмулятора используйте `http://10.0.2.2:1234`
- Для физического устройства используйте IP вашего компьютера в локальной сети

### 3. Запуск MCP сервера

Перед запуском Android приложения необходимо запустить MCP сервер:

```bash
cd ../Mcp/simpletodoistmcp
./gradlew run
```

Сервер будет доступен на `http://localhost:1234`

### 4. Сборка и запуск приложения

```bash
./gradlew assembleDebug
```

Или запустите через Android Studio.

## Функциональность

### Экран "Задачи"

- Показывает список актуальных задач из Todoist
- Задачи форматируются через Yandex GPT для удобного чтения
- Pull-to-refresh для обновления
- Кнопка ручного обновления

### Экран "Настройки"

- **Включить/выключить напоминания** - переключатель для активации системы напоминаний
- **Время начала** - с какого часа начинать отправлять уведомления (0-23)
- **Время окончания** - до какого часа отправлять уведомления (0-23)
- **Интервал напоминаний** - как часто отправлять уведомления в минутах (15-240)

### Система уведомлений

- Работает через WorkManager
- Периодически проверяет задачи и отправляет уведомления
- Форматирует задачи через Yandex GPT перед отправкой
- Работает только в заданный временной интервал

## Разрешения

Приложение запрашивает следующие разрешения:

- `INTERNET` - для HTTP запросов к MCP серверу и Yandex GPT API
- `POST_NOTIFICATIONS` - для отправки уведомлений (Android 13+)
- `SCHEDULE_EXACT_ALARM` - для точного планирования напоминаний

## Известные ограничения

1. **MCP сервер должен быть запущен** перед использованием приложения
2. **Требуется подключение к интернету** для работы с Yandex GPT
3. **WorkManager минимальный интервал** - 15 минут из-за ограничений Android

## Troubleshooting

### Приложение не может подключиться к MCP серверу

- Убедитесь, что MCP сервер запущен
- Для эмулятора проверьте, что используется `http://10.0.2.2:1234`
- Для физического устройства используйте IP компьютера в локальной сети

### Не приходят уведомления

- Проверьте, что напоминания включены в настройках
- Убедитесь, что разрешение на уведомления предоставлено
- Проверьте, что текущее время находится в заданном интервале

### Ошибки при форматировании задач

- Проверьте правильность API ключей Yandex GPT в `local.properties`
- Убедитесь, что есть интернет-соединение

## Разработка

### Добавление новых функций

1. Создайте feature ветку
2. Реализуйте изменения согласно Clean Architecture
3. Обновите соответствующие слои (data, domain, presentation)
4. Тестируйте на эмуляторе или физическом устройстве

### Структура DI

Все зависимости управляются через Hilt:
- `NetworkModule` - HTTP клиенты и API
- `DataModule` - DataStore и репозитории
- `RepositoryModule` - binding интерфейсов к реализациям

## Лицензия

MIT

